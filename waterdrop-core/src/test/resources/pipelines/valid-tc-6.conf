spark {

}

input {
  fileStream {
    path = "/tmp/waterdrop/stream1"
  }
}

filter {
  split {
    delimiter = ","
    fields = ["key", "value"]
  }
}

pipeline<p1> {
  filter {
    sql {
      sql = """
        select * from t1 where key = 'k1'
        """
      table_name = "t1"
    }
  }
  output {

    stdout {}
  }
}

pipeline<p2> {
  filter {
    sql {
      sql = """
        select * from t1 where key = 'k2'
        """
      table_name = "t1"
    }
  }
  output {

    stdout {}
  }
}
